##############################################################################
## This file is part of 'SLAC Firmware Standard Library'.
## It is subject to the license terms in the LICENSE.txt file found in the
## top-level directory of this distribution and at:
##    https://confluence.slac.stanford.edu/display/ppareg/LICENSE.html.
## No part of 'SLAC Firmware Standard Library', including this file,
## may be copied, modified, propagated, or distributed except according to
## the terms contained in the LICENSE.txt file.
##############################################################################

TimingFrameRx: &TimingFrameRx
  name: TimingFrameRx
  description: Status of timing frame reception
  size: 0x10000
  #########
  IntField:
  #########
    #########################################################
    - offset: 0x0000
      name: sofCount
      sizeBits: 32
      lsBit: 0
      mode: RO
      description: Start of frame count
    #########################################################
    - offset: 0x0004
      name: eofCount
      sizeBits: 32
      lsBit: 0
      mode: RO
      description: End of frame count
    #########################################################
    - offset: 0x0008
      name: FidCount
      sizeBits: 32
      lsBit: 0
      mode: RO
      description: Valid frame count
    #########################################################
    - offset: 0x000C
      name: CrcErrCount
      sizeBits: 32
      mode: RO
      description: CRC error count
    #########################################################
    - offset: 0x0010
      name: RxClkCount
      sizeBits: 32
      mode: RO
      description: Recovered clock count div 16
    #########################################################
    - offset: 0x0014
      name: RxRstCount
      sizeBits: 32
      mode: RO
      description: Receive link reset count
    #########################################################
    - offset: 0x0018
      name: RxDecErrCount
      sizeBits: 32
      mode: RO
      description: Receive 8b/10b decode error count
    #########################################################
    - offset: 0x001C
      name: RxDspErrCount
      sizeBits: 32
      mode: RO
      description: Receive disparity error count
    #########################################################
    - offset: 0x0020
      name: RxCountReset
      sizeBits: 1
      lsBit: 0
      mode: RW
      description: Reset receive counters
    #########################################################
    - offset: 0x0020
      name: RxLinkUp
      sizeBits: 1
      lsBit: 1
      mode: RO
      description: Receive link status
    #########################################################
    - offset: 0x0020
      name: RxPolarity
      sizeBits: 1
      lsBit: 2
      mode: RW
      description: Invert receive link polarity 
    #########################################################
    - offset: 0x0020
      name: RxReset
      sizeBits: 1
      lsBit: 3
      mode: RW
      description: Reset receive link
    #########################################################
    - offset: 0x0020
      name: ClkSel
      sizeBits: 1
      lsBit: 4
      mode: RW
      description: Select LCLS-I/LCLS-II Timing
    #########################################################
    - offset: 0x0020
      name: RxDown
      sizeBits: 1
      lsBit: 5
      mode: RW
      description: Latched link down transition
    #########################################################
    - offset: 0x0024
      name: MsgDelay
      sizeBits: 20
      lsBit: 0
      mode: RW
      description: LCLS-II timing frame pipeline delay (186MHz clks)
    #########################################################
    - offset: 0x0028
      name: TxClkCount
      sizeBits: 32
      lsBit: 0
      mode: RO
      description: Transmit clock counter div 16
    #########################################################
  #########
  Commands:
  #########
    #########################################################
    - name: ClearRxCounters
      description: "Clear the Rx status counters."
      sequence:
        - entry: RxCountReset
          value: 0x1
        - entry: RxCountReset
          value: 0x0               
    #########################################################
